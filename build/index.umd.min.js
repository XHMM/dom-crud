!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r((t=t||self).crud={})}(this,function(t){"use strict";function r(t){var r="function"==typeof Symbol&&t[Symbol.iterator],e=0;return r?r.call(t):{next:function(){return t&&e>=t.length&&(t=void 0),{value:t&&t[e++],done:!t}}}}function e(t,r){var e="function"==typeof Symbol&&t[Symbol.iterator];if(!e)return t;var n,o,i=e.call(t),a=[];try{for(;(void 0===r||r-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(e=i.return)&&e.call(i)}finally{if(o)throw o.error}}return a}function n(){for(var t=[],r=0;r<arguments.length;r++)t=t.concat(e(arguments[r]));return t}function o(t){var r=Object.prototype.toString.call(t).split(" ")[1];return r.slice(0,r.length-1).toLowerCase()}function i(t){return t.trim().split(" ").filter(function(t){return""!==t})}function a(t){var r=o(t);return"array"===r?t.every(function(t){return t instanceof Element}):"nodelist"===r||"htmlcollection"===r}function c(t){var r,e="";if(t.includes("-=")?e="-=":t.includes("+=")?e="+=":t.includes("==")&&(e="=="),e){var n=t.indexOf(e),o=t.slice(0,n).trim(),i=l(t.slice(n+2));if(4!==(r=[o,i.v,e,i.c]).length)throw new Error("options item format not correct");return r}throw new Error("options item format not correct")}function u(t){var r=[];try{return Object.entries(t).map(function(t){var e=t[0],n=t[1],i="";if(e.endsWith("-=")?i="-=":e.endsWith("+=")?i="+=":e.endsWith("==")&&(i="=="),!i)throw new Error("options item format not correct");var a=e.match(/.+(?=[-+=]=)/)[0],c=void 0,u=void 0,f=o(n);if("string"===f){var s=l(n);c=s.v,u=s.c}else if("object"===f){if(!n.value)throw new Error("options item format not correct");c=n.value,u=n.config||{}}else c=n,u={};r.push([a,c,i,u])}),r}catch(t){throw t}}function l(t){var r="",e={},n=t.trim().match(/(.*)\?([0-9a-zA-Z&=]*)/);return null===n?r=t:n&&3===n.length&&(r=n[1],e=n[2].split("&").reduce(function(t,r){var e=r.split("=");return"true"===e[1]?!0:"false"===e[1]?!1:e[1].match(/[0-9]+/g)?+e[1]:t[e[0]]=e[1],t},{})),{v:r,c:e}}function f(t){var e,i,a=[];try{for(var l=r(t),f=l.next();!f.done;f=l.next()){var s=f.value;"string"==o(s)?a.push(c(s)):"object"==o(s)&&a.push.apply(a,n(u(s)))}}catch(t){e={error:t}}finally{try{f&&!f.done&&(i=l.return)&&i.call(l)}finally{if(e)throw e.error}}return a}var s={text:{pureText:!1},debug:!1},d={};function m(){d.log=function(){},d.warn=function(){},d.error=function(){}}var g=new Proxy(s,{set:function(t,r,e){return"debug"==r&&(0==e?m():(d.log=function(t,r){console.log("%c[dom-crud:log][%s]\n %c%s","color:#18b7ff;background:rgba(0,0,0,0.02);padding:0.2rem",t,"background:rgba(0,0,0,0.02);padding:0.2rem",r)},d.warn=function(t,r){console.log("%c[dom-crud:warn][%s]\n %c%s","color:orange;background:rgba(0,0,0,0.02);padding:0.2rem",t,"background:rgba(0,0,0,0.02);padding:0.2rem",r)},d.error=function(t,r){console.log("%c[dom-crud:error][%s]\n %c%s","color:red;background:rgba(0,0,0,0.02);padding:0.2rem",t,"background:rgba(0,0,0,0.02);padding:0.2rem",r)})),t[r]=e,!0}});function v(t,e,n){var o,i,c,u;if(!a(e))throw new TypeError("when key is 'doms', value should be array/array-like and from one of Element[], HTMLCollection, NodeList");if(n&&n instanceof Element){if(!t.contains(n))throw new Error("beForeElement not exist in containerElement");try{for(var l=r(e),f=l.next();!f.done;f=l.next()){var s=f.value;t.insertBefore(s,n)}}catch(t){o={error:t}}finally{try{f&&!f.done&&(i=l.return)&&i.call(l)}finally{if(o)throw o.error}}}else try{for(var d=r(e),m=d.next();!m.done;m=d.next()){s=m.value;t.appendChild(s)}}catch(t){c={error:t}}finally{try{m&&!m.done&&(u=d.return)&&u.call(d)}finally{if(c)throw c.error}}}function p(t,r,e,n){"=="==t&&r(),"+="==t&&e(),"-="==t&&n()}m(),t.cdom=function(t){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];var a=document.createElement(t);return f(r).map(function(t){var r,o=e(t,4),c=o[0],u=o[1];switch(o[2],o[3],c){case"class":(r=a.classList).add.apply(r,n(i(u.toString())));break;case"style":a.style.cssText=u.toString();break;case"text":a.textContent=u.toString();break;case"html":a.innerHTML=u.toString();break;case"doms":v(a,u,null);break;default:a.setAttribute(c,u.toString())}}),a},t.ddom=function(t){return t instanceof Element?(t.remove(),!0):(d.warn("ddom","you passed an invalid parameter(type is "+o(t)+"), ddom removed nothing"),!1)},t.getCrudConfig=function(){return JSON.parse(JSON.stringify(g))},t.rdom=function(t){var r=document.querySelector(t);return r?(r.rdom=r.querySelector,r):null},t.rdoms=function(t){return document.querySelectorAll(t)},t.udom=function(t){for(var o=[],c=1;c<arguments.length;c++)o[c-1]=arguments[c];return f(o).map(function(o){var c=e(o,4),u=c[0],l=c[1],f=c[2],m=c[3];switch(u){case"class":p(f,function(){var r;t.className="",(r=t.classList).add.apply(r,n(i(l.toString())))},function(){var r;(r=t.classList).add.apply(r,n(i(l.toString())))},function(){var r;(r=t.classList).remove.apply(r,n(i(l.toString())))});break;case"style":p(f,function(){t.style.cssText=l.toString()},function(){t.style.cssText+=l.toString()},function(){l.toString().split(";").map(function(r){t.style.removeProperty(r)})});break;case"text":var g="pureTex"in m?m.pureText:function(t){if(t in s&&s.hasOwnProperty(t))return s[t];throw new Error(t+" not exists in global crud config")}("text").pureText;p(f,function(){g?t.firstChild.data=l.toString():t.textContent=l.toString()},function(){g?t.firstChild.data+=l.toString():t.textContent+=l.toString()},function(){g?t.firstChild.data="":t.textContent=""});break;case"html":p(f,function(){t.innerHTML=l.toString()},function(){t.innerHTML+=l.toString()},function(){t.innerHTML=""});break;case"doms":p(f,function(){t.innerHTML="",v(t,l,null)},function(){console.log(m),v(t,l,m.before||null)},function(){!function(t,e){var n,o;if(!a(e))throw new TypeError("when key is 'doms', value should be array/array-like and from one of Element[], HTMLCollection, NodeList");try{for(var i=r(e),c=i.next();!c.done;c=i.next()){var u=c.value;u.parentNode==t?u.remove():d.warn("_removeDoms","encountered a dom that is not a child dom, removing skipped")}}catch(t){n={error:t}}finally{try{c&&!c.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}}(t,l)});break;default:p(f,function(){t.setAttribute(u,l.toString())},function(){t.setAttribute(u,l.toString())},function(){t.removeAttribute(u)})}}),t},t.updateCrudConfig=function(t){var r=o(t);if("object"!==r)throw new TypeError("config should be an object, received type is "+r);!function t(r,e){var n=o(r),i=o(e);if("object"!==n||"object"!==i)throw new TypeError("target and source should both be object, received: target is "+n+", source is "+i);for(var a in e)if(e.hasOwnProperty(a)&&a in r){var c="object"==o(r[a]),u="object"==o(e[a]);u||c?c&&u&&t(r[a],e[a]):r[a]=e[a]}}(g,t)},Object.defineProperty(t,"__esModule",{value:!0})});

!function(r){"use strict";function t(r){var t="function"==typeof Symbol&&r[Symbol.iterator],n=0;return t?t.call(r):{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}}}function n(r,t){var n="function"==typeof Symbol&&r[Symbol.iterator];if(!n)return r;var e,o,i=n.call(r),a=[];try{for(;(void 0===t||t-- >0)&&!(e=i.next()).done;)a.push(e.value)}catch(r){o={error:r}}finally{try{e&&!e.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function e(){for(var r=[],t=0;t<arguments.length;t++)r=r.concat(n(arguments[t]));return r}function o(r){var t=Object.prototype.toString.call(r).split(" ")[1];return t.slice(0,t.length-1).toLowerCase()}function i(r){return r.trim().split(" ").filter(function(r){return""!==r})}function a(r){var t=o(r);return"array"===t?r.every(function(r){return r instanceof Element}):"nodelist"===t||"htmlcollection"===t}function c(r){var t,n="";if(r.includes("-=")?n="-=":r.includes("+=")?n="+=":r.includes("==")&&(n="=="),n){var e=r.indexOf(n),o=r.slice(0,e).trim(),i=l(r.slice(e+2));if(4!==(t=[o,i.v,n,i.c]).length)throw new Error("options item format not correct");return t}throw new Error("options item format not correct")}function u(r){var t=[];try{return Object.entries(r).map(function(r){var n=r[0],e=r[1],i="";if(n.endsWith("-=")?i="-=":n.endsWith("+=")?i="+=":n.endsWith("==")&&(i="=="),!i)throw new Error("options item format not correct");var a=n.match(/.+(?=[-+=]=)/)[0],c=void 0,u=void 0,f=o(e);if("string"===f){var s=l(e);c=s.v,u=s.c}else if("object"===f){if(!e.value)throw new Error("options item format not correct");c=e.value,u=e.config||{}}else c=e,u={};t.push([a,c,i,u])}),t}catch(r){throw r}}function l(r){var t="",n={},e=r.trim().match(/(.*)\?([0-9a-zA-Z&=]*)/);return null===e?t=r:e&&3===e.length&&(t=e[1],n=e[2].split("&").reduce(function(r,t){var n=t.split("=");return"true"===n[1]?!0:"false"===n[1]?!1:n[1].match(/[0-9]+/g)?+n[1]:r[n[0]]=n[1],r},{})),{v:t,c:n}}function f(r){var n,i,a=[];try{for(var l=t(r),f=l.next();!f.done;f=l.next()){var s=f.value;"string"==o(s)?a.push(c(s)):"object"==o(s)&&a.push.apply(a,e(u(s)))}}catch(r){n={error:r}}finally{try{f&&!f.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}return a}var s={log:function(){},warn:function(){},error:function(){}};function d(){s.log=function(){},s.warn=function(){},s.error=function(){}}d();var m={text:{pureText:!1},debug:!1},g=new Proxy(m,{set:function(r,t,n){return"debug"==t&&(!1===n&&d(),!0===n&&(s.log=function(r,t){console.log("%c[dom-crud:log][%s]\n %c%s","color:#18b7ff;background:rgba(0,0,0,0.02);padding:0.2rem",r,"background:rgba(0,0,0,0.02);padding:0.2rem",t)},s.warn=function(r,t){console.log("%c[dom-crud:warn][%s]\n %c%s","color:orange;background:rgba(0,0,0,0.02);padding:0.2rem",r,"background:rgba(0,0,0,0.02);padding:0.2rem",t)},s.error=function(r,t){console.log("%c[dom-crud:error][%s]\n %c%s","color:red;background:rgba(0,0,0,0.02);padding:0.2rem",r,"background:rgba(0,0,0,0.02);padding:0.2rem",t)})),r[t]=n,!0}});function v(r,n,e){var o,i,c,u;if(!a(n))throw new TypeError("when key is 'doms', value should be array/array-like and from one of Element[], HTMLCollection, NodeList");if(e&&e instanceof Element){if(!r.contains(e))throw new Error("beForeElement not exist in containerElement");try{for(var l=t(n),f=l.next();!f.done;f=l.next()){var s=f.value;r.insertBefore(s,e)}}catch(r){o={error:r}}finally{try{f&&!f.done&&(i=l.return)&&i.call(l)}finally{if(o)throw o.error}}}else try{for(var d=t(n),m=d.next();!m.done;m=d.next()){s=m.value;r.appendChild(s)}}catch(r){c={error:r}}finally{try{m&&!m.done&&(u=d.return)&&u.call(d)}finally{if(c)throw c.error}}}function h(r,t,n,e){"=="==r&&t(),"+="==r&&n(),"-="==r&&e()}r.cdom=function(r){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var a=document.createElement(r);return f(t).map(function(r){var t,o=n(r,2),c=o[0],u=o[1];switch(c){case"class":(t=a.classList).add.apply(t,e(i(u.toString())));break;case"style":a.style.cssText=u.toString();break;case"text":a.textContent=u.toString();break;case"html":a.innerHTML=u.toString();break;case"doms":v(a,u,null);break;default:a.setAttribute(c,u.toString())}}),a},r.ddom=function(r){return r instanceof Element?(r.remove(),!0):(s.warn("ddom","you passed an invalid parameter(type is "+o(r)+"), ddom removed nothing"),!1)},r.getCrudConfig=function(){return JSON.parse(JSON.stringify(g))},r.rdom=function(r){var t=document.querySelector(r);return t?(t.rdom=t.querySelector,t):null},r.rdoms=function(r){return document.querySelectorAll(r)},r.udom=function(r){for(var o=[],c=1;c<arguments.length;c++)o[c-1]=arguments[c];f(o).map(function(o){var c=n(o,4),u=c[0],l=c[1],f=c[2],d=c[3];switch(u){case"class":h(f,function(){var t;r.className="",(t=r.classList).add.apply(t,e(i(l.toString())))},function(){var t;(t=r.classList).add.apply(t,e(i(l.toString())))},function(){var t;(t=r.classList).remove.apply(t,e(i(l.toString())))});break;case"style":h(f,function(){r.style.cssText=l.toString()},function(){r.style.cssText+=l.toString()},function(){l.toString().split(";").map(function(t){r.style.removeProperty(t)})});break;case"text":var g="pureTex"in d?d.pureText:function(r){if(r in m&&m.hasOwnProperty(r))return m[r];throw new Error(r+" not exists in global crud config")}("text").pureText;h(f,function(){g?r.firstChild.data=l.toString():r.textContent=l.toString()},function(){g?r.firstChild.data+=l.toString():r.textContent+=l.toString()},function(){g?r.firstChild.data="":r.textContent=""});break;case"html":h(f,function(){r.innerHTML=l.toString()},function(){r.innerHTML+=l.toString()},function(){r.innerHTML=""});break;case"doms":h(f,function(){r.innerHTML="",v(r,l,null)},function(){v(r,l,d.before||null)},function(){!function(r,n){var e,o;if(!a(n))throw new TypeError("when key is 'doms', value should be array/array-like and from one of Element[], HTMLCollection, NodeList");try{for(var i=t(n),c=i.next();!c.done;c=i.next()){var u=c.value;u.parentNode==r?u.remove():s.warn("_removeDoms","encountered a dom that is not a child dom, removing skipped")}}catch(r){e={error:r}}finally{try{c&&!c.done&&(o=i.return)&&o.call(i)}finally{if(e)throw e.error}}}(r,l)});break;default:h(f,function(){r.setAttribute(u,l.toString())},function(){r.setAttribute(u,l.toString())},function(){r.removeAttribute(u)})}})},r.updateCrudConfig=function(r){var t=o(r);if("object"!==t)throw new TypeError("config should be an object, received type is "+t);!function r(t,n){var e=o(t),i=o(n);if("object"!==e||"object"!==i)throw new TypeError("target and source should both be object, received: target is "+e+", source is "+i);for(var a in n)if(n.hasOwnProperty(a)&&a in t){var c="object"==o(t[a]),u="object"==o(n[a]);u||c?c&&u&&r(t[a],n[a]):t[a]=n[a]}}(g,r)}}(this.window=this.window||{});
